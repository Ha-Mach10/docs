# Microsoft Excelã‚„Google Spreadsheetã®A1è¡¨ç¤ºã«ãŠã‘ã‚‹åˆ—åã‹ã‚‰ã®åˆ—æ•°ç®—å‡ºæ–¹æ³•

## ğŸš€ æœ€åˆã«

---

`Microsoft Excel`ã‚„`Google Spreadsheet`ã¨ã„ã£ãŸè¡¨è¨ˆç®—ã‚½ãƒ•ãƒˆã«ã¯**A1**è¡¨ç¤ºã¨å‘¼ã°ã‚Œã‚‹è¡¨ç¤ºå½¢å¼ãŒå­˜åœ¨ã™ã‚‹ã€‚
ä¸‹è¨˜ã®ã‚ˆã†ã«**A,B,C**ã¨è¨˜è¼‰ã•ã‚ŒãŸåˆ—ã¨**1,2,3**ã¨è¨˜è¼‰ã•ã‚ŒãŸè¡Œã‹ã‚‰ãªã‚‹2æ¬¡å…ƒã®è¡¨ã§ã‚ã‚‹ã€‚

||A|B|C|...|
|:-:|:-:|:-:|:-:|:-:|
|1|||||
|2|||||
|3|||||

è¡¨è¨ˆç®—ã«ãŠã„ã¦è‡ªå‹•åŒ–ã¯çã—ããªãã€å‹¤å‹‰ãªè«¸å…„ã¯`VBA`ã‚„`GAS`ãªã©ã‚’ç”¨ã„ã¦è‡ªå‹•åŒ–ã‚’è©¦ã¿ã€æœ€é©ãªã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ¨¡ç´¢ã—ã¦ã„ã‚‹ã¨æ€ã†ã€‚
ãŸã ã€è‡ªå‹•åŒ–ã«ãŠã„ã¦è©¦è¡ŒéŒ¯èª¤ã—ã¦ã„ã‚‹ã†ã¡ã€å£ã«çªãå½“ãŸã‚‹ã“ã¨ãŒã¾ã¾ã‚ã‚‹ã“ã¨ã ã‚ã†ã€‚
ä»Šå›ã¯ãã®å£ã®ä¸€éƒ¨ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å½“ã¦ã¦ã„ããŸãæ€ã†ã€‚

## âœ¨ åˆ—åã‹ã‚‰åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ç®—å‡ºã—ãŸã„

---

ã•ã¦ãã®èª²é¡Œã§ã‚ã‚‹ãŒã€ãšã°ã‚Š

### åˆ—åã‹ã‚‰åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å–å¾—ã—ãŸã„

ã“ã‚Œã«å°½ãã‚‹ã€‚
ã€Œãªã‚“ã ã€ãã‚“ãªã®ä¸€åº¦A1å½¢å¼ã§Rangeã‹ã‚‰å–å¾—ã™ã‚Œã°ã„ã„ã˜ã‚ƒãªã„ã‹ã€ã¨æ€ã†ã‹ã‚‚ã—ã‚Œãªã„ã€‚

### ãã‚“ãªã®ã‚¨ãƒ¬ã‚¬ãƒ³ãƒˆã˜ã‚ƒãªã„ğŸ˜­ğŸ˜­ğŸ˜­

ã‚ãŒã¾ã¾ã«èã“ãˆã‚‹ã‹ã‚‚ã—ã‚Œãªã„ãŒã€ã‚¨ãƒ¬ã‚¬ãƒ³ãƒˆã•ã¨æ±ç”¨æ€§ã€åˆ©ä¾¿æ€§ã‚’å…¼ã­å‚™ãˆã¦ã“ãã®ã‚³ãƒ¼ãƒ‰ã§ã‚ã‚‹ã¨ä¿¡ã˜ã¦ã„ã‚‹ã€‚
å®Ÿä½“ã«ä¾å­˜ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã¯å¯èƒ½ã§ã‚ã‚Œã°æ›¸ããŸããªã„ã¨ã„ã†ã®ãŒæ€§åˆ†ã ã€‚
ã“ã“ã¯ã‚†ãšã‚Œãªã„ã€‚

ã¡ãªã¿ã«åˆ—åã‹ã‚‰åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å–å¾—ã—ãŸã„ã¨ã„ã†ã®ã¯å…·ä½“çš„ã«ä¸‹è¨˜ã®ã‚ˆã†ãªæ“ä½œã§ã‚ã‚‹ã€‚

ã‚ã‚‹é–¢æ•° $ f(x) $ã€€ãŒå­˜åœ¨ã—ãŸã¨ã

\[
    f(x)
\]

ãã®é–¢æ•° $ f(x) $ ã¯ä»»æ„é•·ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆï¼ˆå¤§æ–‡å­—ï¼‰ã§æ§‹æˆã•ã‚ŒãŸæ–‡å­—åˆ—ã‚’ä¸ãˆãŸã¨ãä»»æ„ã®å€¤ã‚’è¿”ã™ã“ã¨ãŒã§ãã‚‹ã€‚
ä¸‹è¨˜ã«ä¾‹ã‚’ç¤ºã™ã€‚

(ä¾‹1)ã€€AAAåˆ—
\[
    x:='AAA'\\
    f(x)=703\\
\]

(ä¾‹2)ã€€GXFASSEã«ã¤ã„ã¦
\[
    x:='GXFASSE'\\
    f(x)=2450336231\\
\]

## 10é€²æ•°,26é€²æ•°,A1è¡¨è¨˜ã®æ¯”è¼ƒ

---

- 0-9ã‚’ä½¿ã£ãŸ10é€²æ•°
- A-Zã®è¨˜å·ã‚’ä½¿ã£ãŸ26é€²æ•°
- A1è¡¨è¨˜ã®åˆ—ç•ªå·

ã“ã®ä¸‰ã¤ã«ã¤ã„ã¦æ¯”è¼ƒã‚’ã—ã¦ã¿ã‚‹

|10é€²æ•°|26é€²æ•°|A1è¡¨è¨˜|
|:-:|:-:|:-:|
|000|AAAA|----|
|001|AAAB|---A|
|002|AAAC|---B|
|003|AAAD|---C|
|...|... |... |
|025|AAAZ|---Y|
|026|AABA|---Z|
|027|AABB|--AA|
|028|AABC|--AB|
|...|... |... |

ä¸€èˆ¬çš„ãªné€²æ•°ã§ã¯**ã‚¼ãƒ­**[^1]ã«å¯¾å¿œã™ã‚‹è¨˜å·ãŒå­˜åœ¨ã—ã¦ãŠã‚Šã€10é€²æ•°ã§ã¯`0`ã€26é€²æ•°ã§ã¯`A`ãŒãã®å½¹å‰²ã‚’æ‹…ã†ã€‚
å¯¾ã—ã¦ã€A1è¡¨è¨˜ã«ã¯ã‚¼ãƒ­ã«å¯¾å¿œã™ã‚‹è¨˜å·ãŒã¤ã„ã¦ã„ãªã„ã€‚
ä¸Šè¨˜è¡¨ã§ã¯ä»£ã‚ã‚Šã«`-`ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŒã€ç¹°ã‚Šä¸ŠãŒã‚Šã®éš›ã«`-`ã®æ‰±ã„ã«å›°ã£ã¦ã—ã¾ã†ã€‚
ï¼ˆâ€»è¡¨è¨ˆç®—ã‚½ãƒ•ãƒˆã§ã¯`A`ã‹ã‚‰å§‹ã¾ã£ã¦ãŠã‚Šã€`A`ã®åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®å€¤ãŒ1ã§ã‚ã‚‹ãŸã‚ã€‚ã‚¼ãƒ­ã«ã‚ãŸã‚‹è¨˜å·ãŒå­˜åœ¨ã—ãªã„ã“ã¨ã«ã‚ˆã‚‹ï¼‰


## è¨ˆç®—å¼

---

ä¸Šè¨˜ã‚„å…ˆã®ä¾‹é¡Œã‹ã‚‰ã€å„æ¡ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆã®ç•ªæ•°ã¨26ã®æ¡ã”ã¨ã®æŒ‡æ•°ä¹—ã‚ˆã‚Šä¸‹è¨˜ã®ã‚ˆã†ã«ä¸€èˆ¬åŒ–å¯èƒ½ã§ã‚ã‚‹ã€‚
ã¾ãšä»»æ„ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆ1æ–‡å­—ã‚’å…¥åŠ›ã—ãŸéš›ã«æ•°å€¤ã‚’è¿”ã™é–¢æ•° $ f(d) $ ã‚’ä¸‹è¨˜ã«å®šç¾©ã™ã‚‹ã€‚
\[
    \begin{equation*}
        f(d)=
        \begin{cases}
            0,\hspace{5mm}d='A'\\
            1,\hspace{5mm}d='B'\\
            2,\hspace{5mm}d='C'\\
            \vdots\\
            25,\hspace{5mm}d='Z'
        \end{cases}
    \end{equation*}
\]

ã™ã‚‹ã¨ä»»æ„é•·ã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆãŒæ¸¡ã•ã‚ŒãŸã¨ãã®å€¤ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã‚‹ã€‚

\[
    \sum_{i=0}^{D_{max}} f(D[i])\cdot26^i
\]

ãŸã ã—ã€$ D $ ã¯26é€²æ•°ã®æ•°ã‚’ç¤ºã—ã€ $ D[i] $ ã¯å³ã‹ã‚‰iç•ªç›®ã®æ¡ã®æ–‡å­—ã‚’è¡¨ã—ã¦ã„ã‚‹ã€‚
ã¾ãŸ $ D_{max} $ ã¯ $ D $ ã®æœ€å¤§æ¡ã®ç•ªå·ã‚’è¡¨ã™ã‚‚ã®ã¨ã™ã‚‹ã€‚

ã¾ãŸA1è¡¨è¨˜ã«ã¦è¨ˆç®—ã‚’è¡Œã†å ´åˆã€ä¸Šè¨˜å¼ã§ã¯Aã®ã¨ã0ä¹—ç®—ãŒè¡Œã‚ã‚Œã‚‹ãŸã‚ã€é–¢æ•° $ f $ ã®å€¤ã¸1ã‚’åŠ ç®—ã—ã€ä¸‹è¨˜ã®ã‚ˆã†ã«å†å®šç¾©ã™ã‚‹ã€‚

\[
    \sum_{i=0}^{D_{max}} \Big[f(D[i])+1\Big]\cdot26^i
\]

\[
    \begin{align*}
    \sum_{i=0}^{D_{max}}\Big[f(D[i])+1\Big]\cdot26^i=\Bigl(f(d_0)+1\Bigl)\cdot26^0+\Bigl(f(d_1)+1\Bigl)\cdot26^1+\dots+\Bigl(f(d_i)+1\Big)\cdot26^i
    \end{align*}
\]

## ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®å®Ÿè£…

---

**TypeScript** (â€»ä»£è¡¨ã¨ã—ã¦è¡¨ç¤º)

```typescript
const a1ColumnStringToNumber = (value: string): number =>
  value
  .toUpperCase()
  .split("")
  .filter(x => /^[A-z]+$/).test(x))
  .reverse()
  .map((c, index) => (c.charCodeAt(0) - 64) * (26 ** index))
  .reduce((tmpSum, x) => tmpSum + x, 0);
```

<details><summary>JavaScript</summary>

```javascript
function a1ColumnStringToNumber(value) {
    // regex pattern.
    const VALID_PATTERN = /^[A-Za-z]+$/;

    // Error handling.
    // ------------------------------------------
    // 1. type guard.
    if (typeof value !== 'string') {
        throw new TypeError("The provided value must be a string.");
    }
    // 2. pattern match.
    if (!VALID_PATTERN.test(value)) {
        throw new Error("The specified value must contain only alphabetical characters. For example, 'A' or 'AB'.");
    }

    // split & arrange & calcurate
    return value
    .toUpperCase()
    .split("")
    .reverse()
    .map((c, index) => (c.charCodeAt(0) - 64) * (26 ** index))
    .reduce((tmpSum, x) => tmpSum + x, 0);
}
```

</details>

<details><summary>C#</summary>

```Csharp
using System;
using System.Linq;
using System.Text.RegularExpressions;

// ... other codes.

private static decimal A1ColumnStringToInt(string value)
{
    if (string.IsNullOrEmpty(value) || !Regex.IsMatch(value, "^[A-Za-z]+$"))
    {
        throw new ArgumentException("The specified value must be a non-empty string and contain only alphabetical characters. (e.g., 'A', 'AZ')", nameof(value));
    }

    return value
    .ToUpper()
    .Reverse()
    .Select((c, index) =>
    {
        // A-Zã®å€¤ã®è¨ˆç®—(A=1ã¨ã—ãŸå ´åˆ)
        decimal decimalChar = Convert.ToDecimal(c - 64);
        // 26 ^ indexã®è¨ˆç®—.
        decimal powerdNumber = Convert.ToDecimal(Math.Pow(26, index));

        return decimalChar * powerdNumber;
    })
    .Sum();
}

// ... other codes.
```

</details>

<details><summary>VBA</summary>

```VBA
```

</details>

\[
    \mathbb{K} = \{X_1, X_2,X_3, \ldots, X_n\}ã¨ãªã‚‹ã‚ˆã†ãªé›†åˆ\mathbb{K}ãŒå­˜åœ¨ã—ãŸå ´åˆã€ \\
    \\
    è‡ªç„¶æ•°ã®é›†åˆã‚’\mathbb {N}ã¨ã—ã¦\mathbb{K} = \{(X, n) \mid 1 \leq X \leq 26, 1 \leq n \leq \mathbb{N} \} ãŒæˆã‚Šç«‹ã¤ã¨ã \\
     \\
\]

æ³¨é‡ˆ

[^1]:ã“ã“ã§ã„ã†**ã‚¼ãƒ­**ã¨ã¯æ¦‚å¿µãã®ã‚‚ã®ã‚’æŒ‡ã™ã€‚
**ä½å–ã‚Šè¡¨è¨˜ã§ç©ºæ¬„ã‚’ç¤ºã™ãŸã‚ã®è¨˜å·**ã¨ã—ã¦ã®ã‚¼ãƒ­ã‚’ç¤ºã™ã€‚
